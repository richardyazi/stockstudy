# 股票趋势练习网站需求文档

## 📋 项目概述
**项目名称**：股票趋势练习网站 
**核心功能**：以特定日期为分界点，分别展示股票的历史走势和未来走势

## 🎯 核心功能需求

### 1. 股票选择与时间分界点设置
- **股票代码输入**：支持输入股票代码，提供自动补全功能
- **日期选择器**：精确到日的分界点设置,支持手动输入
- **数据验证**：验证股票代码有效性和日期合理性
- **历史数据范围设置**：允许用户自定义历史走势显示的时间范围（如最近3个月、6个月、1年）

### 2. 用户交互流程与数据展示
- **默认显示模式**：输入股票代码和时间分界点后，系统自动加载并默认显示历史走势图表
- **历史/未来切换**：提供直观的切换控件（标签页或按钮），允许用户在历史走势和未来走势之间无缝切换
- **对比分析模式**：支持分屏或叠加显示历史与未来走势，便于用户发现趋势关系和模式
- **数据加载状态**：提供友好的加载提示和错误处理机制

### 3. 可复用图表组件系统
- **通用图表核心**：设计可复用的图表组件，支持历史和未来数据的统一展示
- **数据适配层**：通过适配器模式处理历史数据和未来数据的格式转换
- **配置驱动**：图表显示参数（时间范围、技术指标、颜色方案）通过配置对象动态控制
- **组件参数化**：核心图表组件接收数据源和显示参数，自动渲染相应图表

### 4. 历史走势图表（分界点前）
- **K线图展示**：显示选定日期前的历史价格走势，支持MA、MACD等指标叠加
- **时间周期选择**：支持日线、周线、月线切换
- **成交量副图**：配合显示交易量变化，叠加MAVOL5、MAVOL10、MAVOL100移动成交量指标
- **KDJ副图**：配合显示KDJ变化，包含K线、D线、J线
- **时间轴缩放**：支持图表时间范围调整
- **交互功能**：鼠标悬停显示详细数据点
- **分界点标记**：在图表上明确标记时间分界点位置

### 5. 未来走势图表（分界点后）
- **复用K线图功能**：复用历史走势图表的K线图展示功能
- **技术指标**：支持MA、MACD等指标叠加
- **预测区间**：显示可能的波动范围
- **关键标记**：标记重要价格水平
- **置信度显示**：对未来走势预测提供置信度指标
- **多方案对比**：支持多种预测方案的对比展示

## 🛠️ 技术方案

### 前端技术栈
- **框架**：React 18 + TypeScript
- **UI组件**：shadcn/ui（基于Tailwind CSS）
- **图表库**：Recharts（专业的图表可视化）
- **构建工具**：Vite

### 数据源
- **股票API**：使用AKShare开源金融数据接口库
- **数据获取**：Python后端服务通过AKShare获取A股实时和历史数据
- **数据格式**：JSON REST API
- **缓存机制**：Redis缓存减少数据请求，提升响应速度
- **数据特性**：支持A股、港股、美股、期货、基金等多种金融数据

## 🎨 设计风格
- **主题**：深色主题，科技金融风格
- **配色**：蓝色调科技感配色
- **布局**：左侧控制面板，右侧图表展示区（支持横向页签切换）
- **交互**：玻璃态卡片设计，响应式布局，横向页签切换

## 📈 K线图区域技术指标展示设计（参考同花顺等专业股票软件）

### 1. K线图整体布局结构

#### 主图区域（K线图）
- **布局比例**：占据图表区域约60%的高度
- **K线显示**：传统蜡烛图（红涨绿跌）
  - 阳线（上涨）：空心红色/白色，上影线和下影线为实线
  - 阴线（下跌）：实心绿色/黑色，上影线和下影线为实线
- **移动平均线叠加**：
  - MA5：白色线
  - MA10：黄色线
  - MA20：紫色线
  - MA60：浅蓝色线
- **网格系统**：浅灰色虚线网格，不干扰K线主体显示
- **坐标轴**：
  - 左侧价格轴：显示当前价格区间
  - 右侧百分比轴：显示涨跌幅度
  - 底部时间轴：显示交易日期

#### 副图区域（技术指标）
- **布局比例**：占据图表区域约40%的高度，分为多个可配置副图
- **可堆叠设计**：支持技术指标的动态添加/删除和顺序调整
- **副图分隔线**：浅灰色实线分隔各副图区域
- **每个副图高度**：默认80-100px，可根据显示内容动态调整

### 2. 成交量副图（VOL）设计规范

#### 基础显示
- **柱状图样式**：
  - 上涨日：红色空心柱（外框红色，内部透明）
  - 下跌日：绿色实心柱
  - 平盘日：灰色柱
- **移动成交量指标叠加**：
  - MAVOL5：白色线（5日成交量移动平均）
  - MAVOL10：黄色线（10日成交量移动平均）
  - MAVOL100：浅蓝色线（100日成交量移动平均）
- **Y轴标注**：显示成交量值，采用科学计数法（如10万、100万、1000万）
- **标签**：左上角显示"VOL"标识，右上角可显示当前成交量数值

#### 交互功能
- **数据提示**：鼠标悬停显示日期、成交量、MAVOL值
- **单击高亮**：点击某日成交量柱，对应K线图同日期高亮显示

### 3. KDJ副图设计规范

#### 曲线显示
- **K线**：白色实线，表示快速确认线
- **D线**：黄色实线，表示慢速主干线
- **J线**：紫色实线，表示乖离线
- **超买/超卖区域标识**：
  - 超买区（80以上）：浅红色背景填充区域
  - 超卖区（20以下）：浅绿色背景填充区域
  - 中性区（20-80）：无填充

#### 数值范围
- **Y轴范围**：0-100固定范围
- **刻度线**：20、50、80三个关键刻度线
- **标签**：左上角显示"KDJ(9,3,3)"标识，右上角显示最新K、D、J值

#### 信号标记
- **金叉标记**：K线从下向上穿过D线，显示金色小圆点
- **死叉标记**：K线从上向下穿过D线，显示蓝色小圆点

### 4. MACD副图设计规范

#### 基础显示
- **DIFF线**：白色实线，表示短期与长期EMA差值
- **DEA线**：黄色实线，表示DIFF线的平滑移动平均
- **MACD柱状图**：
  - 正值（金叉）：红色空心柱
  - 负值（死叉）：绿色实心柱
  - 零轴线：浅灰色虚线

#### 数值范围
- **Y轴**：动态范围，根据MACD值自动调整
- **缩放比例**：保持MACD柱状图显示清晰
- **标签**：左上角显示"MACD(12,26,9)"标识，右上角显示最新DIFF、DEA、MACD值

#### 信号增强
- **零轴穿越标记**：
  - 上穿零轴：显示向上三角形标记
  - 下穿零轴：显示向下三角形标记
- **柱状图变色**：连续增加/减少时柱状图颜色加深

### 5. 图表交互控件设计

#### 顶部工具栏
- **时间周期切换**：分时、日线、周线、月线切换按钮
- **技术指标选择**：下拉菜单或图标按钮，添加/删除副图指标
- **绘图工具**：趋势线、支撑/压力线、矩形、圆形等绘图工具
- **全屏/恢复**：全屏显示图表或恢复原始布局

#### 右键菜单
- **指标参数设置**：点击指标可调整参数（如KDJ的9,3,3周期）
- **删除指标**：从图表中移除指定技术指标
- **添加指标**：从指标库添加新的技术指标
- **样式设置**：调整指标线颜色、粗细等视觉样式

#### 缩放与平移
- **鼠标滚轮缩放**：滚动鼠标滚轮放大/缩小时间轴
- **拖拽平移**：按住鼠标左键拖动图表查看不同时间段
- **双击重置**：双击图表恢复默认显示范围
- **十字光标**：按住Ctrl键显示精确的十字光标，便于精确读数

### 6. 数据联动与同步机制

#### 多图联动
- **时间轴同步**：主图与副图的时间轴完全同步
- **数据点联动**：鼠标悬停在某一图表时，所有图表同一日期数据点同步高亮
- **分界点标记**：历史和未来图表中的分界点位置同步标记

#### 历史与未来切换
- **平滑过渡**：历史与未来图表切换时采用淡入淡出效果
- **数据保持**：切换时保持相同的时间范围和缩放比例
- **指标连续**：确保技术指标在切换时保持计算连续性

## 💡 用户体验增强

### 1. 交互设计
- **流畅切换动画**：历史/未来走势切换时采用平滑过渡动画
- **数据联动高亮**：分界点在历史和未来图表中同步高亮显示
- **手势操作支持**：支持移动端触摸滑动、缩放等手势操作
- **键盘快捷键**：提供常用操作的键盘快捷键支持

### 2. 数据可视化增强
- **趋势线自动绘制**：基于历史数据自动识别并绘制支撑线和压力线
- **关键事件标记**：在图表中标记重要市场事件（如财报发布、政策变动等）
- **多时间维度对比**：支持同一股票不同时间段的对比分析
- **关联性提示**：智能提示历史模式与未来走势的可能关联性

## 🔧 技术实现细节

### 1. 图表复用架构
```typescript
// 通用图表接口设计
interface ChartData {
  date: string;
  open: number;
  close: number;
  high: number;
  low: number;
  volume: number;
  // 技术指标数据
  ma5?: number;
  ma10?: number;
  ma20?: number;
  macd?: number;
  kdj?: { k: number; d: number; j: number };
}

// 图表组件属性
interface StockChartProps {
  data: ChartData[];
  indicators: string[]; // 要显示的技术指标
  timeRange: { start: string; end: string };
  type: 'historical' | 'future';
  onTimePointSelect?: (date: string) => void;
}
```

### 2. 数据管理策略
- **状态管理**：使用React Context或Redux管理全局股票数据和用户设置
- **本地缓存**：利用浏览器本地存储缓存常用股票数据，减少网络请求
- **增量更新**：对于实时数据，采用增量更新策略降低数据传输量
- **错误重试**：实现智能重试机制，处理网络不稳定情况

### 3. 性能优化
- **图表渲染优化**：大数据量时采用数据采样和虚拟化技术
- **组件懒加载**：非首屏组件采用懒加载策略
- **预加载机制**：用户输入时智能预加载可能需要的股票数据
- **响应式设计**：适配不同屏幕尺寸，特别是移动端优化

## 📊 开发计划（6个阶段）

### 阶段1：基础架构搭建
- 实现基础项目结构和主页面布局框架
- 搭建组件系统基础架构，设计可复用的图表组件接口
- 实现基础状态管理机制
- 配置开发和构建环境

### 阶段2：控制面板开发
- 开发股票代码输入和自动补全功能
- 实现日期选择器和历史数据范围设置
- 添加数据验证和错误处理机制
- 实现用户偏好设置的本地存储

### 阶段3：数据服务集成
- 集成AKShare股票API数据获取服务
- 实现Python后端API接口和数据处理逻辑
- 添加数据缓存和性能优化机制
- 实现数据适配层，统一历史和未来数据格式

### 阶段4：通用图表组件开发
- 实现可复用的K线图核心组件
- 开发技术指标计算和显示功能（MA、MACD、KDJ等）
- 实现图表交互功能（缩放、悬停提示、数据点选择）
- 添加图表主题和样式配置系统

### 阶段5：历史走势功能实现
- 实现历史走势图表的数据展示
- 添加成交量副图和指标叠加功能
- 实现时间轴调整和周期切换功能
- 添加分界点标记和关键事件显示

### 阶段6：未来走势与交互优化
- 实现未来走势图表展示功能
- 开发历史/未来走势切换机制和动画效果
- 实现对比分析模式和趋势预测显示
- 优化用户体验，添加手势操作和键盘快捷键支持

---

**文档创建时间**：2025-12-09  
**项目状态**：需求分析完成，待开发确认